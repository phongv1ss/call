<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nhom17_thu4_cachieu</title>

    <!-- Import CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css" />
    <link rel="stylesheet" href="/style.css" />

    <!-- Import Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = { 
        apiKey : "AIzaSyA8wxJd1W4Yk4NIKHO8SaDl6AkGFRocukA" , 
        authDomain: "callvid-807e1.firebaseapp.com",
  projectId: "callvid-807e1",
  storageBucket: "callvid-807e1.appspot.com",
        messagingSenderId : "117676189102" , 
        appId : "1:117676189102:web:3679f23b59b6e0f207d43f" , 
        measurementId : "G-00D5Z3FR4V" 
};

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Ki·ªÉm tra tr·∫°ng th√°i ƒëƒÉng nh·∫≠p
        onAuthStateChanged(auth, (user) => {
            if (!user) {
                window.location.href = "login.html";
            } else {
                document.getElementById("username").textContent = user.displayName || "Ng∆∞·ªùi d√πng";
            }
        });

        // ƒêƒÉng xu·∫•t
        window.logout = function () {
            signOut(auth).then(() => {
                localStorage.removeItem("google_token");
                window.location.href = "login.html";
            }).catch((error) => {
                console.error("ƒêƒÉng xu·∫•t th·∫•t b·∫°i", error);
            });
        };
    </script>

    <!-- Import th∆∞ vi·ªán -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.20.0/dist/axios.min.js"></script>
    <script src="https://cdn.stringee.com/sdk/web/2.2.1/stringee-web-sdk.min.js"></script>
</head>
<body>
    <div class="container has-text-centered" v-cloak id="app">
        <h1 class="title">
            b√†i t·∫≠p call video c·ªßa <span class="header-highlight">Nh√≥m 17 - th·ª© 4-ca chi·ªÅu</span>
        </h1>

        <!-- Hi·ªÉn th·ªã t√™n ng∆∞·ªùi d√πng -->
        <p class="subtitle" >Xin ch√†o, <strong id="username">...</strong> üëã</p>

        <div>
            <button class="button is-primary" v-if="!room" @click="createRoom">
                T·∫°o Ph√≤ng
            </button>
            
            <button class="button is-info" v-if="!room" @click="joinWithId">
                Tham gia ph√≤ng
            </button>

            <button class="button is-info" v-if="room" @click="publish(true)">
                Chia s·∫ª m√†n h√¨nh
            </button>

            <button class="button is-danger" v-if="room" @click="leaveRoom">
                R·ªùi ph√≤ng
            </button>
            
            <!-- N√∫t ƒëƒÉng xu·∫•t -->
            <button class="button is-warning" onclick="logout()">ƒêƒÉng xu·∫•t</button>
        </div>

        <div v-if="roomId" class="info">
            <p>B·∫°n ƒëang ·ªü trong room <strong>{{roomId}}</strong>.</p>
            <p>
                G·ª≠i link n√†y cho b·∫°n b√® c√πng tham gia:
                <a v-bind:href="roomUrl" target="_blank">{{roomUrl}}</a>.
            </p>
            <p>Ho·∫∑c copy m√£ <code>{{roomId}}</code> ƒë·ªÉ chia s·∫ª.</p>
        </div>
    </div>

    <div class="container">
        <div id="videos"></div>
    </div>

    <script src="/api.js"></script>
    <script src="/script.js"></script>
</body>
</html>
